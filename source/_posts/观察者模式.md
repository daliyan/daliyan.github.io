---
title: 观察者模式
id: 33
categories:
  - android
date: 2015-04-07 23:25:46
tags:
---

观察者模式属于23中涉及模式中应用最为广泛的一种，特别是在一些GUI的界面更新和数据更新中应用。在android中观察者模式应用也非常的常见，例如，事件的监听、广播的发送等等.那到底什么事观察者模式呢？

### 一、什么是观察者模式

我们来看看《Head first》一书 中对观察者模式是怎么描述的：**定义了对象这之间一对多的依赖，这样一来，当一个对象改变状态的时候，它的所有依赖都会收到通知并自动更新。**

[![QQ截图20150407223926](http://www.akiyamayzw.com/wp-content/uploads/2015/04/QQ截图20150407223926-300x223.png)](http://www.akiyamayzw.com/wp-content/uploads/2015/04/QQ截图20150407223926.png)

&nbsp;

主题（Subject）和观察者（Observer）定义了一对多的关系，观察者依赖于此主题，只要主题的状态发生改变观察者就会被通知，根据通知的风格，观察者可能因此而更新新值。我们来看一下UML图：

![](http://www.yesky.com/20020603/observer.gif)

我们来看一下每个对象的作用和关联关系：

1.Subject 抽象主题角色：也就是抽象的被观察者对象，里面保存了所有的观察者对象引用列表，提供了注册和反注册的功能。

2.ConcreteSubject具体的主题角色：<span class="comment">将有关状态存入各ConcreteObserver对象</span> <span class="comment">   当它的状态发送改变时，向它的各个观察者发出通知</span> 。

3.Observer 抽象观察者 ：为所有的具体观察者定义一个接口，在得到通知时更新自己。

4.ConcreteObserver 具体观察者：<span class="comment">维护一个指向ConcreteObserver对象的引用</span> ，<span class="comment">存储有关状态，这些状态应与目标的状态保持一致，</span><span class="comment">实现Observer的更新接口是自身状态与目标的状态保持一致</span>

如果，还不明白，我们举一个常见的例子，医院里面很多病人等待做某件事情，比如等待看医生、等待拿药等等，当轮到某人的时候，护士会通知病人，比如轮到张三，护士会喊“张三”，这时候张三就会去做对应的事情。这个过程中护士就是被观察者对象，护士手中的病人名单就是保存的观察者对象引用，病人就是观察者。每一个病人会订阅某些事件，比如张三可能感兴趣的事件就是当护士喊”张三“这个事件。当然后面来的某些病人也可以排到护士的名单中，名单上的病人也可以告诉护士取消看病等等。护士不关心通知完病人后你去你是去看病还是拿药，因为这是病人决定的事情，护士只是起到一个通知的作用。

### 二、适用性

1.  <span class="comment">当一个抽象模型有两个方面，其中一个方面依赖于另一方面</span> 。
2.  <span class="comment">将这两者封装成独立的对象中以使它们可以各自独立的改变和服用</span> 。
3.  <span class="comment">当对一个对象的改变需要同时改变其他对象，而不知道具体有多少对象有待改变</span> 。
4.  <span class="comment">当一个对象必须通知其它对象，而它又不能假定其它对象是谁</span> 。